<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>カウンセリングシート / チェックシート</title>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <style>
        /* 右端の細いナビ（固定） */
        .side-nav {
            position: fixed;
            right: -5px;
            top: 80%;
            transform: translateY(-50%) translateX(15px);
            background: #13ca5e;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 4px;
            border-radius: 10px 0 0 10px;
            z-index: 1000;
            width: 35px;
        }

        .side-nav a:active {
            transform: scale(1.0);
        }

        .side-nav a {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            font-size: 10px;
            margin: 5px 0;
            padding: 5px;
            transition: background 0.3s, transform 0.2s;
            border-radius: 5px;
            width: 30px;
            height: 30px;
            text-align: center;
        }

        .side-nav a span {
            font-size: 24px;
            position: absolute;
            left: -0px;
            top: 13px;
        }

        @media (max-width: 600px) {
            .side-nav {
                right: 2px;
                width: 30px;
            }

            .side-nav a {
                width: 28px;
                height: 28px;
            }

            .side-nav a i {
                font-size: 12px;
            }
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f7f7f7;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100vh;
            margin: 0;
            padding-top: 20px;
        }

        .container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 500px;
            padding: 20px;
            box-sizing: border-box;
            margin-bottom: 40px;
        }

        h1 {
            background: linear-gradient(135deg, #13ca5e, #0fa958);
            color: white;
            padding: 20px;
            border-radius: 0 15px 0px 45px;
            text-align: center;
            display: block;
            margin: -20px -15px 20px -15px;
            font-size: 22px;
            font-weight: 600;
            box-shadow: inset 0 -5px 10px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .label {
            display: block;
            margin-bottom: 10px;
            padding: 3px;
            font-weight: 600;
            background-color: #13ca5e;
            color: white;
            border-radius: 6px;
            font-size: 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        input[type="text"],
        input[type="tel"],
        input[type="date"],
        textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 16px;
            transition: all 0.3s;
        }

        .one-buttons,
        .two-buttons,
        .three-buttons,
        .four-buttons,
        .five-buttons,
        .six-buttons,
        .seven-buttons,
        .eight-buttons,
        .nine-buttons,
        .ten-buttons,
        .eleven-buttons,
        .twelve-buttons,
        .thirteen-buttons,
        .fourteen-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .one-buttons button,
        .two-buttons button,
        .three-buttons button,
        .four-buttons button,
        .five-buttons button,
        .six-buttons button,
        .seven-buttons button,
        .eight-buttons button,
        .nine-buttons button,
        .ten-buttons button,
        .eleven-buttons button,
        .twelve-buttons button,
        .thirteen-buttons button,
        .fourteen-buttons button {
            flex: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #f7f7f7;
            cursor: pointer;
            box-sizing: border-box;
            text-align: center;
            white-space: nowrap;
        }

        .one-buttons button.active,
        .two-buttons button.active,
        .three-buttons button.active,
        .four-buttons button.active,
        .five-buttons button.active,
        .six-buttons button.active,
        .seven-buttons button.active,
        .eight-buttons button.active,
        .nine-buttons button.active,
        .ten-buttons button.active,
        .eleven-buttons button.active,
        .twelve-buttons button.active,
        .thirteen-buttons button.active,
        .fourteen-buttons button.active {
            background-color: #444;
            color: #fff;
        }

        .submit-button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 4px;
            background-color: #dc3545;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
        }

        .submit-button:hover {
            background-color: #c82333;
        }

        .info-text {
            margin: 20px 0;
            font-family: "Noto Sans JP", "Roboto", sans-serif;
            font-size: 14px;
            color: #333;
            background-color: #f8f9fa;
            line-height: 1.8;
            text-align: left;
            word-wrap: break-word;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ced4da;
            max-width: 800px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
        }

        input:focus,
        textarea:focus {
            border-color: #13ca5e;
            outline: none;
            box-shadow: 0 0 8px rgba(0, 123, 255, 0.2);
        }

        button {
            padding: 12px;
            border: none;
            border-radius: 6px;
            background-color: #13ca5e;
            color: #000000;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            background-color: #e9e9e9;
            transform: scale(1.05);
        }

        button.active {
            outline: 2px solid #696969;
            outline-offset: 2px;
        }

        .required {
            color: #ffffff;
            font-weight: lighter;
            font-size: 0.6em;
            margin-left: 5px;
            vertical-align: 0.8em;
            background-color: rgb(255, 15, 15);
            padding: 0 5px;
            border-radius: 3px;
            margin-right: 5px;
        }

        /* 体調チェック用 */
        .condition-list {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .condition-list label {
            width: 50%;
            box-sizing: border-box;
            font-size: 13px;
            margin-bottom: 6px;
            padding-right: 8px;
        }

        .condition-list input[type="checkbox"] {
            margin-right: 4px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 20px;
            }

            .condition-list label {
                width: 100%;
            }
        }

        input[type="date"] {
            width: 100%;        /* 親幅に合わせる */
            max-width: 260px;   /* それ以上は広がらないよう制限 */
            display: block;
            margin: 0 auto 20px; /* 中央寄せ＋下に余白 */
        }
        
    </style>
</head>

<body>
    <!-- 右側の追従ナビ -->
    <div class="side-nav" id="sideNav">
        <a href="#section-message">
            <span>⇩</span>
            <i class="fas fa-comment"></i>
        </a>
    </div>

    <div class="container">
        <h1>カウンセリングシート / チェックシート</h1>
        <div class="info-text">
            以下全て入力後【送信】ボタンを押してください
        </div>

        <!-- カウンセリングシート：基本情報 -->
        <div class="label"><span class="required">必須</span>氏名</div>
        <textarea id="name" rows="1" placeholder="氏名を入力してください"></textarea>

        <div class="label">施術日</div>
        <input type="date" id="treatmentDate">

        <div class="label"><span class="required">必須</span>連絡先</div>
        <input type="text" id="contact" placeholder="電話番号など">

        <div class="label"><span class="required">必須</span>生年月日</div>
        <input type="date" id="birth">

        <div class="label"><span class="required">必須</span>住所</div>
        <textarea id="address" rows="2" placeholder="住所を入力してください"></textarea>

        <!-- カウンセリングシート：質問 1〜14 -->
        <div class="label"><span class="required">必須</span>1. 現在妊娠しておられますか？</div>
        <div class="one-buttons">
            <button type="button" class="one" onclick="selectone(this)">はい</button>
            <button type="button" class="one" onclick="selectone(this)">いいえ</button>
        </div>

        <div class="label"><span class="required">必須</span>2. 薬・食品・化粧品などで皮膚に発疹や蕁麻疹が出たり、具合が悪くなったことはありませんか？</div>
        <div class="two-buttons">
            <button type="button" class="two" onclick="selecttwo(this)">ある</button>
            <button type="button" class="two" onclick="selecttwo(this)">ない</button>
        </div>
        <textarea id="q2_detail" rows="1" placeholder="※ある場合は内容（薬・食品・化粧品など）をお書きください"></textarea>

        <div class="label"><span class="required">必須</span>3. ひきつけ、痙攣を起こしたことはありますか？</div>
        <div class="three-buttons">
            <button type="button" class="three" onclick="selectthree(this)">はい</button>
            <button type="button" class="three" onclick="selectthree(this)">いいえ</button>
        </div>

        <div class="label"><span class="required">必須</span>4. 今までに特別な病気<br>（先天性異常・心臓・肝臓・腎臓免疫不全症・その他の病気）<br>にかかり医師の診断を受けていますか？</div>
        <div class="four-buttons">
            <button type="button" class="four" onclick="selectfour(this)">はい</button>
            <button type="button" class="four" onclick="selectfour(this)">いいえ</button>
        </div>
        <textarea id="q4_detail" rows="1" placeholder="※はいの場合は具体的にご記入ください"></textarea>

        <div class="label"><span class="required">必須</span>5. 最近1ヶ月の間に病気にかかりましたか？</div>
        <div class="five-buttons">
            <button type="button" class="five" onclick="selectfive(this)">はい</button>
            <button type="button" class="five" onclick="selectfive(this)">いいえ</button>
        </div>

        <div class="label"><span class="required">必須</span>6. 最近1週間の間に風邪ひきリンパ腺が腫れましたか？</div>
        <div class="six-buttons">
            <button type="button" class="six" onclick="selectsix(this)">はい</button>
            <button type="button" class="six" onclick="selectsix(this)">いいえ</button>
        </div>
        <textarea id="q6_detail" rows="1" placeholder="※はいの場合は病名などをご記入ください"></textarea>

        <div class="label"><span class="required">必須</span>7. 今日普段と違って具合の悪いところがありますか？</div>
        <div class="seven-buttons">
            <button type="button" class="seven" onclick="selectseven(this)">はい</button>
            <button type="button" class="seven" onclick="selectseven(this)">いいえ</button>
        </div>
        <textarea id="q7_detail" rows="1" placeholder="※はいの場合は具体的にご記入ください"></textarea>

        <div class="label"><span class="required">必須</span>8. 現在、別のエステサロンに通われていますか？</div>
        <div class="eight-buttons">
            <button type="button" class="eight" onclick="selecteight(this)">はい</button>
            <button type="button" class="eight" onclick="selecteight(this)">いいえ</button>
        </div>
        <textarea id="q8_detail" rows="1" placeholder="※はいの場合は施術名をご記入ください"></textarea>

        <div class="label"><span class="required">必須</span>9. 痩身を受けてたことがありますか？</div>
        <div class="nine-buttons">
            <button type="button" class="nine" onclick="selectnine(this)">はい</button>
            <button type="button" class="nine" onclick="selectnine(this)">いいえ</button>
        </div>

        <div class="label"><span class="required">必須</span>10. 最近サウナ風呂によく通いますか？</div>
        <div class="ten-buttons">
            <button type="button" class="ten" onclick="selectten(this)">はい</button>
            <button type="button" class="ten" onclick="selectten(this)">いいえ</button>
        </div>

        <div class="label"><span class="required">必須</span>11. 美容整形を受けられていますか？<br>また、その部位は？</div>
        <div class="eleven-buttons">
            <button type="button" class="eleven" onclick="selecteleven(this)">はい</button>
            <button type="button" class="eleven" onclick="selecteleven(this)">いいえ</button>
        </div>
        <textarea id="q11_detail" rows="1" placeholder="※はいの場合は部位をご記入ください"></textarea>

        <div class="label"><span class="required">必須</span>12. 現在ペースメーカーをご利用になられていますか？</div>
        <div class="twelve-buttons">
            <button type="button" class="twelve" onclick="selecttwelve(this)">はい</button>
            <button type="button" class="twelve" onclick="selecttwelve(this)">いいえ</button>
        </div>

        <div class="label"><span class="required">必須</span>13. ボルトや金属を体内に入れていますか？<br>また、その部位は？</div>
        <div class="thirteen-buttons">
            <button type="button" class="thirteen" onclick="selectthirteen(this)">はい</button>
            <button type="button" class="thirteen" onclick="selectthirteen(this)">いいえ</button>
        </div>
        <textarea id="q13_detail" rows="1" placeholder="※はいの場合は部位をご記入ください"></textarea>

        <div class="label"><span class="required">必須</span>14. マッサージを受けた時に発熱や異常反応を起こしたことがありますか？</div>
        <div class="fourteen-buttons">
            <button type="button" class="fourteen" onclick="selectfourteen(this)">はい</button>
            <button type="button" class="fourteen" onclick="selectfourteen(this)">いいえ</button>
        </div>

        <hr>

        <!-- 体調チェック項目 -->
        <div class="label">体調チェック項目（当てはまるものにチェック）</div>
        <div class="condition-list">
            <!-- 左列 -->
            <label><input type="checkbox" name="condition" value="体温は低い方である。">体温は低い方である。</label>
            <label><input type="checkbox" name="condition" value="朝、目覚めが悪い。">朝、目覚めが悪い。</label>
            <label><input type="checkbox" name="condition" value="朝よく顔が浮腫む">朝よく顔が浮腫（むく）む</label>
            <label><input type="checkbox" name="condition" value="朝起きると鼻水もしくはクシャミが出る。">朝起きると鼻水もしくはクシャミが出る。</label>
            <label><input type="checkbox" name="condition" value="朝、頭がぼーっとする。">朝、頭がぼーっとする。</label>
            <label><input type="checkbox" name="condition" value="よく寝ても疲れが取れない。">よく寝ても疲れが取れない。</label>
            <label><input type="checkbox" name="condition" value="手足がいつも冷えて冷たい">手足がいつも冷えて冷たい</label>
            <label><input type="checkbox" name="condition" value="朝起きた時に息が気になる">朝起きた時に息が気になる</label>
            <label><input type="checkbox" name="condition" value="歯を磨くと血が出る事がある">歯を磨くと血が出る事がある</label>
            <label><input type="checkbox" name="condition" value="疲れ目がひどい。">疲れ目がひどい。</label>
            <label><input type="checkbox" name="condition" value="頭痛を起こしやすい。">頭痛を起こしやすい。</label>
            <label><input type="checkbox" name="condition" value="欠伸（あくび）をよくする。">欠伸（あくび）をよくする。</label>
            <label><input type="checkbox" name="condition" value="ため息をよくする。">ため息をよくする。</label>
            <label><input type="checkbox" name="condition" value="何事もやる気が出ない。">何事もやる気が出ない。</label>
            <label><input type="checkbox" name="condition" value="偏食気味である。">偏食気味である。</label>

            <!-- 右列 -->
            <label><input type="checkbox" name="condition" value="風邪をひきやすい。">風邪をひきやすい。</label>
            <label><input type="checkbox" name="condition" value="吹出物がよく出る。">吹出物がよく出る。</label>
            <label><input type="checkbox" name="condition" value="傷の治りが遅い。">傷の治りが遅い。</label>
            <label><input type="checkbox" name="condition" value="肌に潤いがない。">肌に潤いがない。</label>
            <label><input type="checkbox" name="condition" value="目の下によく隈ができる。">目の下によく隈（くま）ができる。</label>
            <label><input type="checkbox" name="condition" value="尿の回数は1日6回以下である。">尿の回数は1日6回以下である。</label>
            <label><input type="checkbox" name="condition" value="便秘がちである。">便秘がちである。</label>
            <label><input type="checkbox" name="condition" value="肩こりがひどい。">肩こりがひどい。</label>
            <label><input type="checkbox" name="condition" value="首が凝っていて、いつも重たい感じがする。">首が凝っていて、いつも重たい感じがする。</label>
            <label><input type="checkbox" name="condition" value="腰が痛い。">腰が痛い。</label>
            <label><input type="checkbox" name="condition" value="生理痛がひどい。">生理痛がひどい。</label>
            <label><input type="checkbox" name="condition" value="汗をあまり普段からかかない。">汗をあまり普段からかかない。</label>
            <label><input type="checkbox" name="condition" value="睡眠時間は6時間以下である。">睡眠時間は6時間以下である。</label>
            <label><input type="checkbox" name="condition" value="足の浮腫がひどいと感じる。">足の浮腫がひどいと感じる。</label>
            <label><input type="checkbox" name="condition" value="運動不足である。">運動不足である。</label>
        </div>

        <!-- 食生活に関するチェックリスト -->
        <div class="label">食生活に関するチェックリスト</div>

        <label>1日の食事の回数は何回ですか？</label>
        <input type="text" id="mealCount" placeholder="例）3">

        <label>食事の時間は規則的ですか？</label>
        <label><input type="radio" name="regularMeals" value="はい"> はい</label>
        <label><input type="radio" name="regularMeals" value="いいえ"> いいえ</label>

        <label>外食の回数は？<br>（　　　）週 （　　　）回</label>
        <input type="text" id="eatingOutWeek" placeholder="何週に">
        <input type="text" id="eatingOutCount" placeholder="何回">

        <label>ファーストフードを食べる回数は？<br>（　　　）週 （　　　）回</label>
        <input type="text" id="fastFoodWeek" placeholder="何週に">
        <input type="text" id="fastFoodCount" placeholder="何回">

        <label>間食（おやつ等）の回数は？<br>（　　　）週 （　　　）回（1日　　回）</label>
        <input type="text" id="snackWeek" placeholder="何週に">
        <input type="text" id="snackCount" placeholder="何回">
        <input type="text" id="snackPerDay" placeholder="1日何回か">

        <label>回数が少ない場合などはどのような頻度かご記入ください</label>
        <textarea id="snackNote" rows="2"></textarea>

        <label>飲み物は1日にどのくらい飲みますか？</label>
        <label>水（　　　リットル　　　ml）</label>
        <input type="text" id="waterL" placeholder="水：　リットル">
        <input type="text" id="waterMl" placeholder="水：　ml">
        <label>お茶（　　　リットル　　　ml）</label>        
        <input type="text" id="teaL" placeholder="お茶：　リットル">
        <input type="text" id="teaMl" placeholder="お茶：　ml">
        <label>その他（缶コーヒー、ジュース等）<br>（　　　リットル　　　ml）</label>
        <input type="text" id="otherDrinkL" placeholder="その他（缶コーヒー、ジュース等）：　リットル">
        <input type="text" id="otherDrinkMl" placeholder="その他：　ml">

        <label>食事の傾向をお答えください</label>
        <p>炭水化物</p>
        <label><input type="radio" name="carbAmount" value="少ない"> 少ない</label>
        <label><input type="radio" name="carbAmount" value="多い"> 多い</label>

        <p>糖 質</p>
        <label><input type="radio" name="sugarAmount" value="少ない"> 少ない</label>
        <label><input type="radio" name="sugarAmount" value="多い"> 多い</label>

        <p>脂 質</p>
        <label><input type="radio" name="fatAmount" value="少ない"> 少ない</label>
        <label><input type="radio" name="fatAmount" value="多い"> 多い</label><br>
        <label><input type="radio" name="fatType" value="動物性"> 動物性</label>
        <label><input type="radio" name="fatType" value="植物性"> 植物性</label>

        <p>蛋白質</p>
        <label><input type="radio" name="proteinAmount" value="少ない"> 少ない</label>
        <label><input type="radio" name="proteinAmount" value="多い"> 多い</label><br>
        <label><input type="radio" name="proteinType" value="動物性"> 動物性</label>
        <label><input type="radio" name="proteinType" value="植物性"> 植物性</label>

        <br><br>
        <button class="submit-button" id="section-message" onclick="submitForm()">送信</button>
    </div>

    <!-- LIFF SDK -->
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
    let oneCount = '';
    let twoCount = '';
    let threeCount = '';
    let fourCount = '';
    let fiveCount = '';
    let sixCount = '';
    let sevenCount = '';
    let eightCount = '';
    let nineCount = '';
    let tenCount = '';
    let elevenCount = '';
    let twelveCount = '';
    let thirteenCount = '';
    let fourteenCount = '';

    // LIFF初期化
    document.addEventListener('DOMContentLoaded', function () {
        liff.init({
            liffId: '2008536428-Lxmp8MpE' // ★自分のLIFF IDに変更
        }).then(() => {
            console.log('LIFF初期化成功');
        }).catch((err) => {
            console.error('LIFF初期化失敗', err);
        });
    });

    // ピンチズーム対策
    document.addEventListener('touchmove', function (event) {
        if (event.scale !== 1) {
            event.preventDefault();
        }
    }, { passive: false });

    // ダブルタップズーム対策
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) {
            event.preventDefault();
        }
        lastTouchEnd = now;
    }, false);

    // ボタン系（1〜14問）
    function selectone(element) {
        const buttons = document.querySelectorAll('.one-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        oneCount = element.innerText;
    }

    function selecttwo(element) {
        const buttons = document.querySelectorAll('.two-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        twoCount = element.innerText;
    }

    function selectthree(element) {
        const buttons = document.querySelectorAll('.three-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        threeCount = element.innerText;
    }

    function selectfour(element) {
        const buttons = document.querySelectorAll('.four-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        fourCount = element.innerText;
    }

    function selectfive(element) {
        const buttons = document.querySelectorAll('.five-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        fiveCount = element.innerText;
    }

    function selectsix(element) {
        const buttons = document.querySelectorAll('.six-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        sixCount = element.innerText;
    }

    function selectseven(element) {
        const buttons = document.querySelectorAll('.seven-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        sevenCount = element.innerText;
    }

    function selecteight(element) {
        const buttons = document.querySelectorAll('.eight-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        eightCount = element.innerText;
    }

    function selectnine(element) {
        const buttons = document.querySelectorAll('.nine-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        nineCount = element.innerText;
    }

    function selectten(element) {
        const buttons = document.querySelectorAll('.ten-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        tenCount = element.innerText;
    }

    function selecteleven(element) {
        const buttons = document.querySelectorAll('.eleven-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        elevenCount = element.innerText;
    }

    function selecttwelve(element) {
        const buttons = document.querySelectorAll('.twelve-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        twelveCount = element.innerText;
    }

    function selectthirteen(element) {
        const buttons = document.querySelectorAll('.thirteen-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        thirteenCount = element.innerText;
    }

    function selectfourteen(element) {
        const buttons = document.querySelectorAll('.fourteen-buttons button');
        buttons.forEach(button => button.classList.remove('active'));
        element.classList.add('active');
        fourteenCount = element.innerText;
    }

    // 共通ヘルパー
    function getCheckedValues(name) {
        return Array.from(document.querySelectorAll('input[name="' + name + '"]:checked'))
            .map(el => el.value);
    }

    function getRadioValue(name) {
        const el = document.querySelector('input[name="' + name + '"]:checked');
        return el ? el.value : '';
    }

    function submitForm() {
        // 基本情報
        const name = document.getElementById('name').value.trim();
        const treatmentDate = document.getElementById('treatmentDate').value;
        const contact = document.getElementById('contact').value.trim();
        const birth = document.getElementById('birth').value;
        const address = document.getElementById('address').value.trim();

        // 詳細テキスト
        const q2_detail = document.getElementById('q2_detail').value.trim();
        const q4_detail = document.getElementById('q4_detail').value.trim();
        const q6_detail = document.getElementById('q6_detail').value.trim();
        const q7_detail = document.getElementById('q7_detail').value.trim();
        const q8_detail = document.getElementById('q8_detail').value.trim();
        const q11_detail = document.getElementById('q11_detail').value.trim();
        const q13_detail = document.getElementById('q13_detail').value.trim();

        // バリデーション（必要なものだけ）
        if (!name) {
            alert('氏名を入力してください。');
            return;
        }
        if (!contact) {
            alert('連絡先を入力してください。');
            return;
        }
        if (!birth) {
            alert('生年月日を入力してください。');
            return;
        }
        if (!address) {
            alert('住所を入力してください。');
            return;
        }

        if (!oneCount) { alert('1. 現在妊娠しておられますか？を選択してください。'); return; }
        if (!twoCount) { alert('2. 薬・食品・化粧品などの質問を選択してください。'); return; }
        if (!threeCount) { alert('3. ひきつけ、痙攣を起こしたことはありますか？を選択してください。'); return; }
        if (!fourCount) { alert('4. 今までに特別な病気にかかり医師の診断を受けていますか？を選択してください。'); return; }
        if (!fiveCount) { alert('5. 最近1ヶ月の病気の質問を選択してください。'); return; }
        if (!sixCount) { alert('6. 最近1週間の間に風邪ひきリンパ腺が腫れましたか？を選択してください。'); return; }
        if (!sevenCount) { alert('7. 今日普段と違って具合の悪いところがありますか？を選択してください。'); return; }
        if (!eightCount) { alert('8. 現在、別のエステサロンに通われていますか？を選択してください。'); return; }
        if (!nineCount) { alert('9. 痩身を受けてたことがありますか？を選択してください。'); return; }
        if (!tenCount) { alert('10. 最近サウナ風呂によく通いますか？を選択してください。'); return; }
        if (!elevenCount) { alert('11. 美容整形を受けられていますか？を選択してください。'); return; }
        if (!twelveCount) { alert('12. 現在ペースメーカーをご利用になられていますか？を選択してください。'); return; }
        if (!thirteenCount) { alert('13. ボルトや金属を体内に入れていますか？を選択してください。'); return; }
        if (!fourteenCount) { alert('14. マッサージを受けた時に発熱や異常反応を起こしたことがありますか？を選択してください。'); return; }

        // 体調チェック
        const conditions = getCheckedValues('condition');
        const conditionText = conditions.length
            ? conditions.map(v => '□ ' + v).join('\n')
            : '（チェックなし）';

        // 食生活
        const mealCount = document.getElementById('mealCount').value.trim();
        const regularMeals = getRadioValue('regularMeals');
        const eatingOutWeek = document.getElementById('eatingOutWeek').value.trim();
        const eatingOutCount = document.getElementById('eatingOutCount').value.trim();
        const fastFoodWeek = document.getElementById('fastFoodWeek').value.trim();
        const fastFoodCount = document.getElementById('fastFoodCount').value.trim();
        const snackWeek = document.getElementById('snackWeek').value.trim();
        const snackCount = document.getElementById('snackCount').value.trim();
        const snackPerDay = document.getElementById('snackPerDay').value.trim();
        const snackNote = document.getElementById('snackNote').value.trim();

        const waterL = document.getElementById('waterL').value.trim();
        const waterMl = document.getElementById('waterMl').value.trim();
        const teaL = document.getElementById('teaL').value.trim();
        const teaMl = document.getElementById('teaMl').value.trim();
        const otherDrinkL = document.getElementById('otherDrinkL').value.trim();
        const otherDrinkMl = document.getElementById('otherDrinkMl').value.trim();

        const carbAmount = getRadioValue('carbAmount');
        const sugarAmount = getRadioValue('sugarAmount');
        const fatAmount = getRadioValue('fatAmount');
        const fatType = getRadioValue('fatType');
        const proteinAmount = getRadioValue('proteinAmount');
        const proteinType = getRadioValue('proteinType');

        // 送信用テキスト整形（bodyの表示に合わせて修正）
        const counselingText =
`≪カウンセリングシート≫
【氏名】${name}
【施術日】${treatmentDate}
【連絡先】${contact}
【生年月日】${birth}
【住所】${address}

1. 現在妊娠しておられますか？
・${oneCount}

2. 薬・食品・化粧品などで皮膚に発疹や蕁麻疹が出たり、具合が悪くなったことはありませんか？
・${twoCount}
　詳細：${q2_detail || 'なし'}

3. ひきつけ、痙攣を起こしたことはありますか？
・${threeCount}

4. 今までに特別な病気
（先天性異常・心臓・肝臓・腎臓免疫不全症・その他の病気）
にかかり医師の診断を受けていますか？
・${fourCount}
　具体的に：${q4_detail || 'なし'}

5. 最近1ヶ月の間に病気にかかりましたか？
・${fiveCount}

6. 最近1週間の間に風邪ひきリンパ腺が腫れましたか？
・${sixCount}
　病名など：${q6_detail || 'なし'}

7. 今日普段と違って具合の悪いところがありますか？
・${sevenCount}
　具体的に：${q7_detail || 'なし'}

8. 現在、別のエステサロンに通われていますか？
・${eightCount}
　施術名：${q8_detail || 'なし'}

9. 痩身を受けてたことがありますか？
・${nineCount}

10. 最近サウナ風呂によく通いますか？
・${tenCount}

11. 美容整形を受けられていますか？
また、その部位は？
・${elevenCount}
　部位：${q11_detail || 'なし'}

12. 現在ペースメーカーをご利用になられていますか？
・${twelveCount}

13. ボルトや金属を体内に入れていますか？
また、その部位は？
・${thirteenCount}
　部位：${q13_detail || 'なし'}

14. マッサージを受けた時に発熱や異常反応を起こしたことがありますか？
・${fourteenCount}`;

        const checkSheetText =
`〈体調チェック項目〉
${conditionText}

〈食生活に関するチェックリスト〉
1日の食事の回数：${mealCount || '未記入'} 回
食事の時間は規則的ですか？：${regularMeals || '未記入'}

外食の回数：${eatingOutWeek || '－'} 週　${eatingOutCount || '－'} 回
ファーストフードを食べる回数：${fastFoodWeek || '－'} 週　${fastFoodCount || '－'} 回
間食（おやつ等）の回数：${snackWeek || '－'} 週　${snackCount || '－'} 回（1日 ${snackPerDay || '－'} 回）
頻度メモ：${snackNote || 'なし'}

飲み物は1日にどのくらい飲みますか？
・水：${waterL || '－'} L / ${waterMl || '－'} ml
・お茶：${teaL || '－'} L / ${teaMl || '－'} ml
・その他（缶コーヒー、ジュース等）：${otherDrinkL || '－'} L / ${otherDrinkMl || '－'} ml

食事の傾向をお答えください
・炭水化物：${carbAmount || '未記入'}
・糖質：${sugarAmount || '未記入'}
・脂質：${fatAmount || '未記入'}（${fatType || '種類 未記入'}）
・蛋白質：${proteinAmount || '未記入'}（${proteinType || '種類 未記入'}）`;

        const sendText = counselingText + "\n\n" + checkSheetText;

        liff.sendMessages([{
            type: 'text',
            text: sendText
        }]).then(() => {
            alert('ご記入ありがとうございます。');
            liff.closeWindow();
        }).catch((err) => {
            console.error('メッセージの送信に失敗しました', err);
            alert('送信に失敗しました。時間をおいて再度お試しください。');
        });
    }
</script>
</body>

</html>
